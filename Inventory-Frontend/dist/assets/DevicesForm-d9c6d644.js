import{j as e,r as m,U as re,b as le,c as te,u as oe,L as q}from"./index-ff15ffff.js";import{u as G}from"./index.esm-928e4bdd.js";import{A as ne}from"./Add-bf24c0ae.js";/* empty css            */import{s as ce}from"./events.controller-c70b4491.js";import{d as ie,g as de,a as me,o as pe,b as ue,u as xe,s as he,c as fe,e as je}from"./devices.controller-1016fee0.js";import{g as ve}from"./workers.controllers-385485ed.js";import{a as be}from"./index.esm-babf0fd6.js";import{E as ye}from"./jspdf.es.min-f229373b.js";import{a as Ne,b as ge}from"./index.esm-4424b7ce.js";import{f as qe}from"./file-download-cca85fc9.js";function _e(){var c;const l=()=>{document.getElementById("modalPage").style.display="None"},{register:j,handleSubmit:p,reset:u,formState:{errors:b}}=G(),a=async o=>{const y=new FormData;y.append("file",o.file[0]);try{const i=await ce(y);console.log(i),i.status==200?swal.fire("Datos guardados","","success").then(()=>{u(),l()}):swal.fire("Lo sentimos algo salio mal","","error").then(()=>{u(),l()})}catch(i){console.log(i)}};return e.jsx("div",{className:"modalPage",id:"modalPage",children:e.jsx("div",{className:"card w-50 mx-auto px-4 py-4 rounded",children:e.jsx("form",{onSubmit:p(a),children:e.jsxs("div",{className:"form-group mx-auto py-2",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{children:"Carga Masiva de datos"}),e.jsx("label",{htmlFor:"",className:"mb-3",children:"Selecciona el archivo con los datos a subir..."}),e.jsx("div",{className:" text-center"})]}),e.jsxs("div",{className:"text-center d-flex flex-column mb-2 align-items-center",children:[((c=b.file)==null?void 0:c.type)=="required"&&e.jsx("p",{className:"errorMsg mb-0",children:"Este campo no puede ir vacio"}),e.jsx("input",{type:"file",className:"form-control mb-3",...j("file",{required:!0})}),e.jsx("p",{className:"errorMsg align-self-center",children:"Recuerda que debe ser un archivo excel (.xls)"})]}),e.jsxs("div",{className:"form-group text-center ",children:[e.jsx("button",{className:"btn btn-success mt-1",children:"Enviar"}),e.jsx("button",{className:"btn btn-danger mx-1 mt-1",type:"button",onClick:l,children:"Cancelar"})]})]})})})})}function we({id:l}){const j=async()=>{try{const a=new ye,o=(await ie(l)).data;console.log(o);var p=10,u=70,b=[];const y=["Nombre","Tipo","Razon","Estado","Importancia","Descripción","Creador evento","Realización"];o.forEach(i=>{const _=[i.eventName,i.event_type_name,i.event_reason_name,i.event_status_name,i.event_importance,i.eventDescription,i.event_created_by_name,i.eventCreatedAt.split("T")[0]];b.push(_)}),a.text(`Hoja del vida del equipo ${o[0].equipment_name}`,65,10),a.text(`Modelo: ${o[0].model}`,10,p+20),a.text(`Serial: ${o[0].serial}`,120,p+20),a.text(`Marca: ${o[0].mark_name}`,10,p+30),a.text(`Estado: ${o[0].status_name}`,120,p+30),a.text(`Reponsable: ${o[0].user_name}`,10,p+40),a.text(`Creado el: ${o[0].created_at.split("T")[0]}`,120,p+40),a.text("Eventos de este equipo",65,60),a.autoTable({body:b,startY:u,head:[y],theme:"striped",headStyles:{lineWidth:1,fillColor:[204,204,255],textColor:[0,0,0]}}),a.save(`Hoja del vida del equipo ${o[0].equipment_name}.pdf`)}catch(a){swal.fire("Este equipo no tiene eventos","Si intentas descargar la informacion de solamente el equipo lo puede haces desde la pagina de equipos","info"),console.log(a)}};return e.jsx("div",{children:e.jsxs("button",{className:"btn btn-info",type:"button",onClick:j,children:["Hoja de vida ",e.jsx(be,{className:"mx-1"})]})})}function ke({id:l}){const[j,p]=m.useState([]);m.useEffect(()=>{l&&(async()=>{try{const c=await de(l);console.log(c.data),p(c.data)}catch{}})()},[]);const u=a=>{Swal.fire({title:"Estas seguro?",text:"No podras recuperar este archivo!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(async c=>{if(c.isConfirmed)try{await me(a),Swal.fire("Deleted!","Your file has been deleted.","success").then(()=>{window.location.reload()})}catch{Swal.fire("Lo sentimos!","Tuvimos un error intenta mas tarde.","error")}})},b=(a,c)=>{le.get(a,{responseType:"blob"}).then(o=>{qe(o.data,c)})};return e.jsx("div",{id:"addModal",className:"back w-100 vh-100 d-flex justify-content-center d-none ",children:e.jsx("div",{className:"mt-1",children:e.jsxs("div",{className:"bg-light h-50 w-100 px-4 py-3 rounded",children:[e.jsxs("div",{className:"d-flex flex-row gap-5 ",children:[e.jsx("div",{className:"",children:e.jsx("button",{className:" btn btn-dark btn-sm mb-2",type:"button",onClick:()=>{document.getElementById("addModal").classList.add("d-none")},children:"Cerrar"})}),e.jsx("h3",{className:"mx-4",children:"Lista de archivos de este equipo"})]}),e.jsx("div",{children:e.jsxs("table",{className:"table table-striped table-hover px-3 py-2 table-responsive",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"Equipo"}),e.jsx("th",{children:"Fecha de subida"}),e.jsx("th",{colSpan:2,children:"Opciones"})]})}),e.jsx("tbody",{children:j&&j.map((a,c)=>e.jsxs("tr",{children:[e.jsx("td",{children:a&&a.original_name}),e.jsx("td",{children:a&&a.equip_name}),e.jsx("td",{children:a&&a.created_at.split("T")[0]}),e.jsxs("td",{colSpan:2,children:[e.jsx("button",{className:"btn btn-primary btn-sm mx-1",onClick:()=>{b(`${re}${a.file_name}`,a.original_name)},children:"Descargar"}),e.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>{u(a.id)},children:"Borrar"})]})]},c))})]})})]})})})}function Le(){var D,M,F,T,A,$,I,P,L,R;const l=te(),[j,p]=m.useState(),{user:u}=oe(),[b,a]=m.useState([]),[c,o]=m.useState([]),[y,i]=m.useState([]),[_,H]=m.useState([]),[k,z]=m.useState([]),[S,w]=m.useState(!1),[h,O]=m.useState({}),[C,Q]=m.useState(""),[E,V]=m.useState(""),{register:r,handleSubmit:W,reset:Y,watch:Se,formState:{errors:v}}=G(),g=(s,d)=>{p([s,d]),document.querySelector("#addModal").classList.remove("inactive")},B=async()=>{try{var s=[],d=[],f=[],n=[];(await ue()).data.map(x=>{if(x.param_state==1)switch(x.paramtype_id){case 201:s.push([x.id,x.name]);break;case 203:n.push([x.id,x.name]);break;case 204:d.push([x.id,x.name]);break;case 208:f.push([x.id,x.name]);break;default:break}}),a(s),H(d),o(f),i(n)}catch(t){console.error("An error occurred:",t)}},U=async s=>{if(l.id){var d=!1;if((await xe(l.id,s)).status===200?d=!0:d=!1,s.files.length>0)try{const n=new FormData;for(let N=0;N<s.files.length;N++)n.append("files",s.files[N]);(await he(l.id,n)).status==200?d=!0:d=!1}catch{swal.fire("El archivo que le agregaste al equipo no se pudo agregar, intenta mas tarde","","error")}d?swal.fire("Datos actualizados","","success").then(()=>{window.location.reload()}):swal.fire("No se pudo actualizar los datos","","error")}else{const f=new FormData;for(let n=0;n<s.files.length;n++)f.append("files",s.files[n]);for(const n in s)n!=="files"&&f.append(n,s[n]);await fe(f)}},J=()=>{B()},K=()=>{document.getElementById("modalPage").style.display="Block"},X=async()=>{try{const s=await ve();z(s.data)}catch(s){console.log(s)}},Z=()=>{document.getElementById("selectChanger").value==263?w(!0):w(!1)},ee=async()=>{try{const f=l.id,n=await je(f),t=n.data[0];t.equipment_type==263&&w(!0),O(n.data[0]);var s=t.ram.toString().split(" "),d=t.hard_disk.toString().split(" ");const N=s[0],x=d[0],se=s[1],ae=d[1];V(ae),Q(se),Y({name:t.name,model:t.model,serial:t.serial,user:t.user,office:t.office,description:t.description,proccesor:t.proccesor,system:t.system,antivirus:t.antivirus,ram:N,hard_disk:x,status:t.status,bought_at:t.bought_at.replaceAll("/","-"),deliver_at:t.deliver_at.replaceAll("/","-"),init_value:t.init_value,final_value:t.final_value,sub_value:t.sub_value,phone:t.phone,location:t.location})}catch(f){console.log(f)}};return m.useEffect(()=>{X(),B(),l.id&&ee()},[]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("div",{children:j&&e.jsx(ne,{param:j[0],val:j[1],OnSaving:J})}),e.jsx(_e,{})]}),e.jsx(ke,{id:l.id}),e.jsx("div",{className:"px-4 py-3",children:e.jsx("form",{action:"",onSubmit:W(U),children:e.jsxs("div",{className:"row",id:"Equip-row",children:[e.jsxs("div",{className:"col-12 col-sm-3  col-md-3 ",children:[e.jsx("label",{children:" Nombre del equipo"}),e.jsx("input",{type:"text",...r("name",{required:!0}),className:"form-control form-control-sm",placeholder:"Nombre del producto..."}),((D=v.name)==null?void 0:D.type)==="required"&&e.jsx("p",{className:"errorMsg",style:{margin:"0px"},children:"Este campo es requerido"})]}),e.jsxs("div",{className:"col-12 col-sm-3 col-md-3",children:[e.jsx("label",{children:"Responsable"}),e.jsxs("select",{...r("user"),className:"form-select form-select-sm",children:[e.jsx("option",{value:"",children:"Selecciona un responsable"}),k&&k.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),((M=v.user)==null?void 0:M.type)==="required"&&e.jsx("p",{className:"errorMsg",style:{margin:"0px"},children:"Este campo es requerido"})]}),e.jsxs("div",{className:" col-6 col-sm-3 col-md-3",children:[e.jsx("label",{htmlFor:"",children:" Modelo"}),e.jsx("input",{type:"text",...r("model",{required:!0}),className:"form-control form-control-sm",placeholder:"Modelo..."}),((F=v.model)==null?void 0:F.type)==="required"&&e.jsx("p",{className:"errorMsg",style:{margin:"0px"},children:"Este campo es requerido"})]}),e.jsxs("div",{className:" col-6 col-sm-3 col-md-3",children:[e.jsx("label",{htmlFor:"",children:" Oficina"}),e.jsx("input",{type:"text",...r("office",{required:!0}),className:"form-control form-control-sm",placeholder:"Oficina..."}),((T=v.office)==null?void 0:T.type)==="required"&&e.jsx("p",{className:"errorMsg",style:{margin:"0px"},children:"Este campo es requerido"})]}),e.jsxs("div",{className:"col-12 col-sm-3 col-md-3",children:[e.jsx("label",{children:"IMEI/Serial"}),e.jsx("input",{type:"text",...r("serial",{required:!0}),className:"form-control form-control-sm",placeholder:"Código de serie"}),((A=v.serial)==null?void 0:A.type)==="required"&&e.jsx("p",{className:"errorMsg",style:{margin:"0px"},children:"Este campo es requerido"})]}),e.jsxs("div",{className:" col-12 col-sm-3 col-md-3",children:[e.jsx("label",{children:"Marca"}),e.jsxs("div",{className:"d-flex flex-row",children:[e.jsxs("select",{...r("mark",{required:!0}),className:"form-select form-select-sm",style:{maxHeight:"31px",overflowY:"auto"},children:[e.jsx("option",{value:"",children:"Selecciona una marca..."}),l.id&&e.jsx("option",{value:h.mark,selected:!0,children:h.mark_name}),b.map(s=>e.jsx("option",{value:s[0],className:h.mark==s[0]?"d-none":"",children:s[1]},s[0]))]}),e.jsx("button",{type:"button",className:"btn btn-secondary addBtn px-2 ",onClick:()=>{g("Marca","201")},children:"+"})]}),(($=v.mark)==null?void 0:$.type)=="required"&&e.jsx("p",{className:"errorMsg",style:{margin:"0px"},children:"Este campo es requerido"})]}),e.jsxs("div",{className:" col-12 col-sm-3 col-md-2",children:[e.jsx("label",{children:"Tipo de equipo"}),e.jsxs("div",{className:"d-flex flex-row",children:[e.jsxs("select",{className:"form-select form-select-sm",id:"selectChanger",...r("equip_type",{required:!0}),onChange:()=>{Z()},children:[e.jsx("option",{value:"",children:"Selecciona el tipo..."}),l.id&&e.jsx("option",{value:h.equipment_type,selected:!0,children:h.equipment_type_name}),c.map(s=>e.jsx("option",{value:s[0],children:s[1]},s[0]))]}),e.jsx("button",{type:"button",className:"btn btn-secondary addBtn px-2",onClick:()=>{g("Tipo de equipo","208")},children:"+"})]}),((I=v.equip_type)==null?void 0:I.type)=="required"&&e.jsx("p",{className:"errorMsg",style:{margin:"0px"},children:"Este campo es requerido"})]}),e.jsxs("div",{className:"col-12 col-sm-6 col-md-2 ",children:[e.jsx("label",{children:"Cantidad de ram"}),e.jsxs("div",{className:"d-flex align-item-center justify-content-center",children:[e.jsx("input",{type:"number",...r("ram"),className:"form-control GB-TB form-control-sm",placeholder:"0"}),e.jsxs("select",{className:"form-select form-select-sm md-3",style:{width:"80px"},...r("formatRam"),children:[e.jsx("option",{value:"GB",selected:C=="GB",children:"GB"}),e.jsx("option",{value:"TB",selected:C=="TB",children:"TB"})]})]})]}),e.jsxs("div",{className:" col-12  col-sm-6 col-md-2 ",children:[e.jsx("label",{htmlFor:"",children:"Cantidad de disco duro"}),e.jsxs("div",{className:"d-flex justify-content-center",children:[e.jsx("input",{type:"number",...r("hard_disk"),className:"form-control form-control-sm",placeholder:"0"}),e.jsxs("select",{className:"form-select form-select-sm md-3 GB-TB",style:{width:"80px"},...r("formatDisk"),children:[e.jsx("option",{value:"GB",selected:E=="GB",children:"GB"}),e.jsxs("option",{value:"TB",selected:E=="TB",children:[" ","TB"]})]})]})]}),e.jsxs("div",{className:" col-12 col-sm-3 col-md-3",children:[e.jsx("label",{children:"Tipo de ram"}),e.jsxs("div",{className:"d-flex flex-row",children:[e.jsxs("select",{...r("ram_type",{required:!0}),className:"form-select form-select-sm",children:[e.jsx("option",{value:"",children:"Tipo de ram"}),l.id&&e.jsx("option",{value:h.ram_type,selected:!0,children:h.ram_type_name}),_.map(s=>e.jsx("option",{value:s[0],className:h.ram_type==s[0]?"d-none":"",children:s[1]},s[0]))]}),e.jsx("button",{type:"button",className:"btn btn-secondary addBtn px-2",onClick:()=>{g("Tipo de ram","204")},children:"+"})]}),((P=v.ram_type)==null?void 0:P.type)=="required"&&e.jsx("p",{className:"errorMsg",style:{margin:"0px"},children:"Este campo es requerido"})]}),e.jsxs("div",{className:" col-12 col-sm-3 col-md-3",children:[e.jsx("label",{children:"Tipo de disco duro"}),e.jsxs("div",{className:"d-flex flex-row",children:[e.jsxs("select",{...r("hard_type",{required:!0}),className:"form-select form-select-sm",children:[e.jsx("option",{value:"",children:"Selecciona el tipo..."}),l.id&&e.jsx("option",{value:h.hard_type,selected:!0,children:h.hard_type_name}),y.map(s=>e.jsx("option",{value:s[0],className:h.hard_type==s[0]?"d-none":"",children:s[1]},s[0]))]}),e.jsx("button",{type:"button",className:"btn btn-secondary btn-sm  addBtn px-2 ",onClick:()=>{g("Tipo de disco duro","203")},children:"+"})]}),((L=v.hard_type)==null?void 0:L.type)=="required"&&e.jsx("p",{className:"errorMsg",style:{margin:"0px"},children:"Este campo es requerido"})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{children:"Procesador"}),e.jsx("input",{type:"text",...r("proccesor"),className:"form-control form-control-sm",placeholder:"Nombre de procesador"})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{children:"Sistema operativo"}),e.jsx("input",{type:"text",...r("system"),className:"form-control form-control-sm",placeholder:"Nombre del sistema operativo"})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{htmlFor:"",children:"Estado del equipo"}),e.jsxs("select",{name:"",id:"",className:"form-select form-select-sm",...r("status"),children:[e.jsx("option",{value:"1",children:"Activo"}),e.jsx("option",{value:"2",children:"Inactivo"})]})]}),e.jsxs("div",{className:"col-md-3 my-2",children:[e.jsx("label",{htmlFor:"",children:"Antivirus"}),e.jsx("input",{type:"text",name:"antivirus",...r("antivirus"),className:"form-control form-control-sm",placeholder:"Antivirus"})]}),e.jsxs("div",{className:"col-md-3 ",children:[e.jsx("label",{htmlFor:"",children:"Fecha de compra"}),e.jsx("input",{type:"date",...r("bought_at"),className:"form-control form-control-sm"})]}),e.jsxs("div",{className:"col-md-3 ",children:[e.jsx("label",{htmlFor:"",children:"Valor inicial"}),e.jsx("input",{type:"number",placeholder:"00...",...r("init_value"),className:"form-control form-control-sm"})]}),e.jsxs("div",{className:"col-md-2 ",children:[e.jsx("label",{htmlFor:"",children:"Valor final"}),e.jsx("input",{type:"number",placeholder:"00...",...r("final_value"),className:"form-control form-control-sm"})]}),e.jsxs("div",{className:"col-md-2 ",children:[e.jsx("label",{children:"Valor subsidiado"}),e.jsx("input",{type:"text",placeholder:"0...",...r("sub_value"),className:"form-control form-control-sm"})]}),l.id?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"col-md-3  d-flex flex-row ",children:[e.jsxs("div",{children:[e.jsx("label",{children:"Agregar/descargar archivos"}),e.jsx("input",{type:"file",multiple:!0,...r("files"),className:"form-control form-control-sm"})]}),e.jsx("div",{className:"align-self-end ",children:e.jsx("button",{type:"button",className:"btn btn-dark w-100",style:{maxHeight:"31px"},onClick:()=>{document.getElementById("addModal").classList.remove("d-none")},children:e.jsx(Ne,{size:"1.5rem",className:"mb-5 align-self-center"})})})]})}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"col-md-3  ",children:[e.jsx("label",{children:"Agregar archivos"}),e.jsx("input",{type:"file",multiple:!0,...r("files"),className:"form-control form-control-sm"})]})}),e.jsxs("div",{className:"col-md-3 ",children:[e.jsx("label",{children:"Fecha de entrega"}),e.jsx("input",{type:"date",...r("deliver_at"),className:"form-control form-control-sm"})]}),e.jsxs("div",{className:"col-md-2 ",children:[e.jsx("label",{htmlFor:"",children:"Ubicación"}),e.jsx("input",{type:"text",placeholder:"Cali, Bogota ...",...r("location"),className:"form-control form-control-sm"})]}),S?e.jsxs("div",{className:"col-md-3 ",children:[e.jsx("label",{children:"Numero Celular"}),e.jsx("input",{type:"text",...r("phone",{required:!0}),placeholder:"3209782***",className:"form-control form-control-sm"})]}):"",e.jsxs("div",{className:S?"col-md-9":"col-md-12",children:[e.jsx("label",{children:"Comentario"}),e.jsx("textarea",{...r("description",{required:!0}),cols:"30",className:"form-control form-control-sm",style:{resize:"none"},placeholder:"Descripción..."}),((R=v.description)==null?void 0:R.type)==="required"&&e.jsx("p",{className:"errorMsg",style:{margin:"0px"},children:"Este campo es requerido"})]}),l.id?e.jsxs("div",{className:"col-md-12",children:[e.jsx("button",{className:"btn btn-success text-center my-3 btn-sm py-2",disabled:u.rol==272,children:e.jsx("span",{className:"px-1",children:"Editar"})}),e.jsx(q,{className:"btn btn-dark mx-1 py-2  btn-sm",to:`/AllEvents/${l.id}`,children:"Ver eventos de este equipo"}),u.rol==272?" ":e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"btn btn-primary   py-2 btn-sm ",to:`/create_event/${l.id}`,children:e.jsx("span",{className:"px-1",children:"Añadir evento "})}),u.rol==273?"":e.jsx(q,{style:{maxHeight:"39px"},className:"btn btn-danger mx-1 btn-sm",onSubmit:s=>{s.preventDefault()},onClick:()=>{pe(l.id)},children:e.jsx(ge,{size:"1.8rem"})})]}),e.jsx(we,{id:l.id})]}):e.jsxs("div",{className:"col-md-12",children:[e.jsx("button",{className:" btn btn-primary text-center my-3",disabled:u.rol==272,children:"Agregar"}),e.jsx(q,{className:"btn btn-success mx-3 ",to:"/equipments",children:"Ver todo"}),e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:K,disabled:u.rol==272,children:"Carga masiva"})]})]})})})]})}export{Le as D};
