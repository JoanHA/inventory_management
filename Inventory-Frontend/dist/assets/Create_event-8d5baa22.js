import{b as I,U as L,r as a,c as H,u as P,d as V,j as e,L as W}from"./index-cbb2da5c.js";/* empty css              */import{A as G}from"./Add-c2de6e88.js";import{u as U}from"./index.esm-ff6dab22.js";import{g as O,a as Q}from"./events.controller-f199cce7.js";import{g as J}from"./workers.controllers-6e8e3a68.js";import{V as K}from"./Volver-547a6aaf.js";import{H as X}from"./Helmet-404090e4.js";/* empty css            */const Y=async o=>I.post(L+"api/events",o);function oe(){var p,x,u,h,f,j,v;const[o,b]=a.useState([]),[c,N]=a.useState(),[w,g]=a.useState(),[y,q]=a.useState(),[Z,S]=a.useState(),[E,_]=a.useState(),F=H(),{user:M}=P(),[d,D]=a.useState([]),R=V(),{register:r,handleSubmit:C,reset:T,formState:{errors:n}}=U();a.useEffect(()=>{(async()=>{const l=F.id,t=await O(l);await A();const i=t.data[0];g(i.name),q(i.serial),S(i.user_name),_(i.id),T({client:t.data[0].user})})()},[]);const A=async()=>{try{const s=await J();D(s.data)}catch(s){console.log(s)}},B=async s=>{Swal.fire({title:"Quieres guardar los cambios?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Guardar",denyButtonText:"No guardar"}).then(async l=>{if(l.isConfirmed){s.equip=E,s.user=M.id,s.file=s.file[0];const t=new FormData;t.append("file",s.file),t.append("name",s.name),t.append("serial",s.serial),t.append("description",s.description),t.append("client",s.client),t.append("equip",s.equip),t.append("user",s.user),t.append("date",s.date),t.append("event_type",s.event_type),t.append("event_reason",s.event_reason),t.append("importance",s.importance),t.append("status",s.status),console.log(s),(await Y(t)).status==200&&Swal.fire("Saved!","","success").then(()=>{R("/events")})}else l.isDenied&&Swal.fire("Lo cambios no han sido guardados","","info")})},k=(s,l)=>{N([s,l]),document.querySelector("#addModal").classList.remove("inactive")},m=async()=>{const s=await Q();s.status==200&&b(s.data)};a.useEffect(()=>{m()},[]);const z=()=>{m()};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[" ",c&&e.jsx(G,{param:c[0],val:c[1],OnSaving:z})]}),e.jsx(X,{children:e.jsx("title",{children:" Crear Evento"})}),e.jsx("div",{className:"card vh-100 w-100 py-1 px-2",style:{border:"None"},children:e.jsxs("div",{className:"contenedor",children:[e.jsxs("div",{className:"event_header d-flex justify-content-between",children:["Nuevo evento"," ",e.jsx(K,{})]}),e.jsxs("div",{className:"equip_data",children:[e.jsx("div",{className:"event_title",children:e.jsx("h3",{children:"datos del equipo"})}),e.jsxs("div",{className:"input-group flex-nowrap   d-flex flex-row  justify-content-center gap-3",children:[e.jsxs("div",{className:"input-group d-flex w-25 flex-row flex-nowrap gap-2 align-items-center",children:[e.jsx("div",{className:"",children:e.jsx("label",{htmlFor:"",children:"Serial"})}),e.jsx("div",{children:e.jsx("input",{type:"text",className:"form-control form-control-sm ",placeholder:"Serial",value:y,disabled:!0})})]}),e.jsxs("div",{className:"input-group d-flex w-25 flex-row flex-nowrap gap-2 align-items-center",children:[e.jsxs("div",{className:"",children:[" ",e.jsx("label",{htmlFor:"",children:" Equipo"})]}),e.jsxs("div",{children:[" ",e.jsx("input",{type:"text",className:"form-control form-control-sm ",placeholder:"Nombre del equipo",value:w,disabled:!0})]})]})]})]}),e.jsxs("div",{className:"event_data",children:[e.jsxs("div",{className:"event_title",children:[" ",e.jsx("h3",{children:"datos del evento"})]}),e.jsx("form",{id:"form-event",className:"container px-0 py-0",onSubmit:C(B),encType:"multipart/form-data",children:e.jsxs("div",{className:"inputGroup w-100 container  d-flex flex-row flex-wrap ",children:[e.jsxs("div",{className:"input-group d-flex flex-column mb-2 w-50 flex-wrap mb-2",children:[e.jsx("label",{htmlFor:"",children:"Nombre del evento"})," ",e.jsx("input",{type:"text",className:"form-control form-control-sm ",placeholder:"Nombre del evento",style:{width:"90% "},...r("name",{required:!0})}),((p=n.name)==null?void 0:p.type)=="required"&&e.jsx("p",{className:"errorMsg mb-0",children:"Este campo es requerido"})]}),e.jsxs("div",{className:"input-group d-flex flex-column  mb-2 flex-wrap w-50 mb-2 flex-wrap",children:[e.jsx("label",{htmlFor:"",children:"Tipo de evento"}),e.jsxs("div",{className:"d-flex flex-row gap-1",children:[e.jsxs("select",{className:"form-select form-select-sm",name:"",id:"",style:{width:"83% "},...r("event_type",{required:!0}),children:[e.jsx("option",{value:"",children:"Tipo de evento"}),o.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx("button",{className:"btn btn-secondary btn-sm",type:"button",onClick:()=>{k("Evento","200")},children:"+"})]}),((x=n.event_type)==null?void 0:x.type)=="required"&&e.jsx("p",{className:"errorMsg mb-0",children:"Este campo es requerido"})]}),e.jsxs("div",{className:"input-group d-flex flex-column  w-50 mb-2 flex-wrap",children:[e.jsx("label",{htmlFor:"",children:"Fecha de realizaciÃ³n"})," ",e.jsx("input",{type:"date",className:"form-control form-control-sm ",placeholder:"Fecha del evento",style:{width:"90% "},...r("date",{required:!0})}),((u=n.date)==null?void 0:u.type)=="required"&&e.jsx("p",{className:"errorMsg mb-0",children:"Este campo es requerido"})]}),e.jsxs("div",{className:"input-group d-flex flex-column  w-50 mb-2 flex-wrap",children:[e.jsx("label",{htmlFor:"",children:"Importancia"})," ",e.jsxs("select",{className:"form-select form-select-sm",name:"",...r("importance",{required:!0}),style:{width:"90% "},id:"",children:[e.jsx("option",{value:"",children:"Selecciona importancia..."}),e.jsx("option",{value:"235",children:"Baja "}),e.jsx("option",{value:"236",children:"Media"}),e.jsx("option",{value:"237",children:"Normal"}),e.jsx("option",{value:"238",children:"Alta"})]}),((h=n.importance)==null?void 0:h.type)=="required"&&e.jsx("p",{className:"errorMsg mb-0",children:"Este campo es requerido"})]}),e.jsxs("div",{className:"input-group d-flex flex-column w-50  mb-2 flex-wrap",children:[e.jsx("label",{htmlFor:"",children:"Razon del evento"})," ",e.jsxs("select",{className:"form-select  form-select-sm",name:"",style:{width:"90% "},id:"",...r("event_reason",{required:!0}),children:[e.jsx("option",{value:"",children:" Razon del evento"}),e.jsx("option",{value:"240",children:"Incidente"}),e.jsx("option",{value:"241",children:"Requerimiento"}),e.jsx("option",{value:"242",children:"Mantenimiento"}),e.jsx("option",{value:"243",children:"Repotenciamiento"})]}),((f=n.event_reason)==null?void 0:f.type)=="required"&&e.jsx("p",{className:"errorMsg mb-0",children:"Este campo es requerido"})]}),e.jsxs("div",{className:"input-group d-flex flex-column  w-50  mb-2 flex-wrap",children:[e.jsx("label",{htmlFor:"",children:"Adjuntar archivo"}),e.jsx("input",{id:"SentFile",type:"file",className:"form-control form-control-sm ",style:{width:"90% "},...r("file")})]}),e.jsxs("div",{className:"input-group d-flex flex-column  w-50  mb-2 flex-wrap",children:[e.jsx("label",{children:"Responsable"}),e.jsxs("select",{style:{width:"90% ",height:"20px"},...r("client"),className:"form-select form-select-sm",children:[e.jsx("option",{value:"",children:" Selecciona un responsable"}),d&&d.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),((j=n.user)==null?void 0:j.type)==="required"&&e.jsx("p",{className:"errorMsg",style:{margin:"0px"},children:"Este campo es requerido"})]}),e.jsxs("div",{className:"input-group d-flex flex-column  w-50  mb-2 flex-wrap",children:[e.jsx("label",{htmlFor:"",children:"Estado"}),e.jsxs("select",{name:"",id:"",className:"form-select form-select-sm",style:{width:"90% "},...r("status"),children:[e.jsx("option",{value:"280",children:"Pendiente"}),e.jsx("option",{value:"281",children:"Cancelado"}),e.jsx("option",{value:"282",children:"Realizado"})]})]}),e.jsxs("div",{className:"input-group d-flex flex-column  mb-2 flex-wrap w-100",children:[e.jsx("label",{htmlFor:"",children:"Descripcion"})," ",e.jsx("textarea",{name:"",id:"",rows:"3",className:"form-control form-control-sm",placeholder:"Descripcion del evento",style:{width:"95%",maxHeight:"100px"},...r("description",{required:!0})}),((v=n.description)==null?void 0:v.type)=="required"&&e.jsx("p",{className:"errorMsg mb-0",children:"Este campo es requerido"})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("button",{className:"btn btn-success btn-sm",children:"Registrar "}),e.jsxs(W,{className:"btn btn-danger btn-sm mx-2",to:"/equipments",children:[" ","Cancelar"]})]})]})})]})]})})]})}export{oe as default};
