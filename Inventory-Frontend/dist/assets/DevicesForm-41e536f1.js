import{j as e,r as x,U as X,b as Z,c as ee,u as se,d as ae,L as g}from"./index-583ba0dd.js";import{u as L}from"./index.esm-5dab2a19.js";import{A as re}from"./Add-d8fe991f.js";/* empty css            */import{s as le}from"./events.controller-323dd8ba.js";import{d as te,g as oe,a as ne,o as ce,b as ie,u as de,s as me,c as pe,e as ue}from"./devices.controller-ab09ccca.js";import{g as xe}from"./workers.controllers-f5f692a9.js";import{a as he}from"./index.esm-7c0aef8c.js";import{E as fe}from"./jspdf.es.min-7fb539e6.js";import{a as je,b as ve}from"./index.esm-45cd40b0.js";import{f as be}from"./file-download-ead365c6.js";function ye(){var n;const l=()=>{document.getElementById("modalPage").style.display="None"},{register:h,handleSubmit:m,reset:p,formState:{errors:v}}=L(),a=async o=>{const b=new FormData;b.append("file",o.file[0]);try{(await le(b)).status==200?swal.fire("Datos guardados","","success").then(()=>{p(),l()}):swal.fire("Lo sentimos algo salio mal","","error").then(()=>{p(),l()})}catch(i){console.log(i)}};return e.jsx("div",{className:"modalPage",id:"modalPage",children:e.jsx("div",{className:"card w-50 mx-auto px-4 py-4 rounded",children:e.jsx("form",{onSubmit:m(a),children:e.jsxs("div",{className:"form-group mx-auto py-2",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{children:"Carga Masiva de datos"}),e.jsx("label",{htmlFor:"",className:"mb-3",children:"Selecciona el archivo con los datos a subir..."}),e.jsx("div",{className:" text-center"})]}),e.jsxs("div",{className:"text-center d-flex flex-column mb-2 align-items-center",children:[((n=v.file)==null?void 0:n.type)=="required"&&e.jsx("p",{className:"errorMsg mb-0",children:"Este campo no puede ir vacio"}),e.jsx("input",{type:"file",className:"form-control mb-3",...h("file",{required:!0})}),e.jsx("p",{className:"errorMsg align-self-center",children:"Recuerda que debe ser un archivo excel (.xls)"})]}),e.jsxs("div",{className:"form-group text-center ",children:[e.jsx("button",{className:"btn btn-success mt-1",children:"Enviar"}),e.jsx("button",{className:"btn btn-danger mx-1 mt-1",type:"button",onClick:l,children:"Cancelar"})]})]})})})})}function Ne({id:l}){const h=async()=>{try{const a=new fe,o=(await te(l)).data;var m=10,p=80,v=[];const b=["Nombre","Tipo","Razon","Estado","Importancia","Descripción","Creador evento","Realización"];o.forEach(i=>{const q=[i.eventName,i.event_type_name,i.event_reason_name,i.event_status_name,i.event_importance,i.eventDescription,i.event_created_by_name,i.eventCreatedAt.split("T")[0]];v.push(q)}),a.text(`Hoja del vida del equipo ${o[0].equipment_name}`,65,10),a.text(`Modelo: ${o[0].model}`,10,m+20),a.text(`Serial: ${o[0].serial}`,120,m+20),a.text(`Marca: ${o[0].mark_name}`,10,m+30),a.text(`Estado: ${o[0].status_name}`,120,m+30),a.text(`Reponsable: ${o[0].user_name}`,10,m+40),a.text(`Creado el: ${o[0].created_at.split("T")[0]}`,10,m+50),a.text("Eventos de este equipo",70,70),a.autoTable({body:v,startY:p,head:[b],theme:"striped",headStyles:{fillColor:[240,248,255],textColor:[0,0,0]}}),a.save(`Hoja del vida del equipo ${o[0].equipment_name}.pdf`)}catch(a){swal.fire("Este equipo no tiene eventos","Si intentas descargar la informacion de solamente el equipo lo puede haces desde la pagina de equipos","info"),console.log(a)}};return e.jsx("div",{children:e.jsxs("button",{className:"btn btn-info",type:"button",onClick:h,children:["Hoja de vida ",e.jsx(he,{className:"mx-1"})]})})}function ge({id:l}){const[h,m]=x.useState([]);x.useEffect(()=>{l&&(async()=>{try{const n=await oe(l);m(n.data)}catch{}})()},[]);const p=a=>{Swal.fire({title:"Estas seguro?",text:"No podras recuperar este archivo!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(async n=>{if(n.isConfirmed)try{await ne(a),Swal.fire("Deleted!","Your file has been deleted.","success").then(()=>{window.location.reload()})}catch{Swal.fire("Lo sentimos!","Tuvimos un error intenta mas tarde.","error")}})},v=(a,n)=>{Z.get(a,{responseType:"blob"}).then(o=>{be(o.data,n)})};return e.jsx("div",{id:"addModal",className:"back w-100 vh-100 d-flex justify-content-center d-none ",children:e.jsx("div",{className:"mt-1",children:e.jsxs("div",{className:"bg-light h-50 w-100 px-4 py-3 rounded",children:[e.jsxs("div",{className:"d-flex flex-row gap-5 ",children:[e.jsx("div",{className:"",children:e.jsx("button",{className:" btn btn-dark btn-sm mb-2",type:"button",onClick:()=>{document.getElementById("addModal").classList.add("d-none")},children:"Cerrar"})}),e.jsx("h3",{className:"mx-4",children:"Lista de archivos de este equipo"})]}),e.jsx("div",{children:e.jsxs("table",{className:"table table-striped table-hover px-3 py-2 table-responsive",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"Equipo"}),e.jsx("th",{children:"Fecha de subida"}),e.jsx("th",{colSpan:2,children:"Opciones"})]})}),e.jsx("tbody",{children:h&&h.map((a,n)=>e.jsxs("tr",{children:[e.jsx("td",{children:a&&a.original_name}),e.jsx("td",{children:a&&a.equip_name}),e.jsx("td",{children:a&&a.created_at.split("T")[0]}),e.jsxs("td",{colSpan:2,children:[e.jsx("button",{className:"btn btn-primary btn-sm mx-1",onClick:()=>{v(`${X}${a.file_name}`,a.original_name)},children:"Descargar"}),e.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>{p(a.id)},children:"Borrar"})]})]},n))})]})})]})})})}function Ae(){var E,F,D,M,B,T,A,$,I,P;const l=ee(),[h,m]=x.useState(),{user:p}=se(),v=ae(),[a,n]=x.useState([]),[o,b]=x.useState([]),[i,q]=x.useState([]),[H,R]=x.useState([]),[k,z]=x.useState([]),[S,_]=x.useState(!1),[u,O]=x.useState({}),{register:t,handleSubmit:V,reset:Y,watch:qe,formState:{errors:f}}=L(),y=(s,d)=>{m([s,d]),document.querySelector("#addModal").classList.remove("inactive")},C=async()=>{try{var s=[],d=[],r=[],c=[];(await ie()).data.map(j=>{if(j.param_state==1)switch(j.paramtype_id){case 201:s.push([j.id,j.name]);break;case 203:c.push([j.id,j.name]);break;case 204:d.push([j.id,j.name]);break;case 208:r.push([j.id,j.name]);break;default:break}}),n(s),R(d),b(r),q(c)}catch(w){console.error("An error occurred:",w)}},U=async s=>{if(l.id){var d=!1;if((await de(l.id,s)).status===200?d=!0:d=!1,s.files.length>0)try{const c=new FormData;for(let N=0;N<s.files.length;N++)c.append("files",s.files[N]);(await me(l.id,c)).status==200?d=!0:d=!1}catch{swal.fire("El archivo que le agregaste al equipo no se pudo agregar, intenta mas tarde","","error")}d?swal.fire("Datos actualizados","","success").then(()=>{v(0)}):swal.fire("No se pudo actualizar los datos","","error")}else{const r=new FormData;for(let c=0;c<s.files.length;c++)r.append("files",s.files[c]);for(const c in s)c!=="files"&&r.append(c,s[c]);await pe(r)}},W=()=>{C()},G=()=>{document.getElementById("modalPage").style.display="Block"},J=async()=>{try{const s=await xe();z(s.data)}catch(s){console.log(s)}},K=()=>{document.getElementById("selectChanger").value==263?_(!0):_(!1)},Q=async()=>{try{const s=l.id,d=await ue(s),r=d.data[0];r.equipment_type==263&&_(!0),O(d.data[0]),Y({name:r.name,model:r.model,serial:r.serial,user:r.user,office:r.office,description:r.description,proccesor:r.proccesor,system:r.system,antivirus:r.antivirus,ram:r.ram,hard_disk:r.hard_disk,status:r.status,bought_at:r.bought_at.replaceAll("/","-"),deliver_at:r.deliver_at.replaceAll("/","-"),init_value:r.init_value,final_value:r.final_value,sub_value:r.sub_value,phone:r.phone,location:r.location})}catch(s){console.log(s)}};return x.useEffect(()=>{J(),C(),l.id&&Q()},[]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("div",{children:h&&e.jsx(re,{param:h[0],val:h[1],OnSaving:W})}),e.jsx(ye,{})]}),e.jsx(ge,{id:l.id}),e.jsx("div",{className:"px-4 py-3",children:e.jsx("form",{action:"",onSubmit:V(U),children:e.jsxs("div",{className:"row",id:"Equip-row",children:[e.jsxs("div",{className:"col-12 col-sm-3  col-md-3 ",children:[e.jsx("label",{children:" Nombre del equipo"}),e.jsx("input",{type:"text",...t("name",{required:!0}),className:"form-control form-control-sm",placeholder:"Nombre del producto..."}),((E=f.name)==null?void 0:E.type)==="required"&&e.jsx("p",{className:"errorMsg",style:{margin:"0px"},children:"Este campo es requerido"})]}),e.jsxs("div",{className:"col-12 col-sm-3 col-md-3",children:[e.jsx("label",{children:"Responsable"}),e.jsxs("select",{...t("user"),className:"form-select form-select-sm",children:[e.jsx("option",{value:"",children:"Selecciona un responsable"}),k&&k.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),((F=f.user)==null?void 0:F.type)==="required"&&e.jsx("p",{className:"errorMsg",style:{margin:"0px"},children:"Este campo es requerido"})]}),e.jsxs("div",{className:" col-6 col-sm-3 col-md-3",children:[e.jsx("label",{htmlFor:"",children:" Modelo"}),e.jsx("input",{type:"text",...t("model",{required:!0}),className:"form-control form-control-sm",placeholder:"Modelo..."}),((D=f.model)==null?void 0:D.type)==="required"&&e.jsx("p",{className:"errorMsg",style:{margin:"0px"},children:"Este campo es requerido"})]}),e.jsxs("div",{className:" col-6 col-sm-3 col-md-3",children:[e.jsx("label",{htmlFor:"",children:" Oficina"}),e.jsx("input",{type:"text",...t("office",{required:!0}),className:"form-control form-control-sm",placeholder:"Oficina..."}),((M=f.office)==null?void 0:M.type)==="required"&&e.jsx("p",{className:"errorMsg",style:{margin:"0px"},children:"Este campo es requerido"})]}),e.jsxs("div",{className:"col-12 col-sm-3 col-md-3",children:[e.jsx("label",{children:"IMEI/Serial"}),e.jsx("input",{type:"text",...t("serial",{required:!0}),className:"form-control form-control-sm",placeholder:"Código de serie"}),((B=f.serial)==null?void 0:B.type)==="required"&&e.jsx("p",{className:"errorMsg",style:{margin:"0px"},children:"Este campo es requerido"})]}),e.jsxs("div",{className:" col-12 col-sm-3 col-md-3",children:[e.jsx("label",{children:"Marca"}),e.jsxs("div",{className:"d-flex flex-row",children:[e.jsxs("select",{...t("mark",{required:!0}),className:"form-select form-select-sm",style:{maxHeight:"31px",overflowY:"auto"},children:[e.jsx("option",{value:"",children:"Selecciona una marca..."}),l.id&&e.jsx("option",{value:u.mark,selected:!0,children:u.mark_name}),a.map(s=>e.jsx("option",{value:s[0],className:u.mark==s[0]?"d-none":"",children:s[1]},s[0]))]}),e.jsx("button",{type:"button",className:"btn btn-secondary addBtn px-2 ",onClick:()=>{y("Marca","201")},children:"+"})]}),((T=f.mark)==null?void 0:T.type)=="required"&&e.jsx("p",{className:"errorMsg",style:{margin:"0px"},children:"Este campo es requerido"})]}),e.jsxs("div",{className:" col-12 col-sm-3 col-md-2",children:[e.jsx("label",{children:"Tipo de equipo"}),e.jsxs("div",{className:"d-flex flex-row",children:[e.jsxs("select",{className:"form-select form-select-sm",id:"selectChanger",...t("equip_type",{required:!0}),onChange:()=>{K()},children:[e.jsx("option",{value:"",children:"Selecciona el tipo..."}),l.id&&e.jsx("option",{value:u.equipment_type,selected:!0,children:u.equipment_type_name}),o.map(s=>e.jsx("option",{value:s[0],children:s[1]},s[0]))]}),e.jsx("button",{type:"button",className:"btn btn-secondary addBtn px-2",onClick:()=>{y("Tipo de equipo","208")},children:"+"})]}),((A=f.equip_type)==null?void 0:A.type)=="required"&&e.jsx("p",{className:"errorMsg",style:{margin:"0px"},children:"Este campo es requerido"})]}),e.jsxs("div",{className:"col-12 col-sm-6 col-md-2 ",children:[e.jsx("label",{children:"Cantidad de ram"}),e.jsx("div",{className:"d-flex align-item-center justify-content-center",children:e.jsx("input",{type:"text",...t("ram"),className:"form-control GB-TB form-control-sm",placeholder:"0 GB"})})]}),e.jsxs("div",{className:" col-12  col-sm-6 col-md-2 ",children:[e.jsx("label",{htmlFor:"",children:"Cantidad de disco duro"}),e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx("input",{type:"text",...t("hard_disk"),className:"form-control form-control-sm",placeholder:"0TB"})})]}),e.jsxs("div",{className:" col-12 col-sm-3 col-md-3",children:[e.jsx("label",{children:"Tipo de ram"}),e.jsxs("div",{className:"d-flex flex-row",children:[e.jsxs("select",{...t("ram_type",{required:!0}),className:"form-select form-select-sm",children:[e.jsx("option",{value:"",children:"Tipo de ram"}),l.id&&e.jsx("option",{value:u.ram_type,selected:!0,children:u.ram_type_name}),H.map(s=>e.jsx("option",{value:s[0],className:u.ram_type==s[0]?"d-none":"",children:s[1]},s[0]))]}),e.jsx("button",{type:"button",className:"btn btn-secondary addBtn px-2",onClick:()=>{y("Tipo de ram","204")},children:"+"})]}),(($=f.ram_type)==null?void 0:$.type)=="required"&&e.jsx("p",{className:"errorMsg",style:{margin:"0px"},children:"Este campo es requerido"})]}),e.jsxs("div",{className:" col-12 col-sm-3 col-md-3",children:[e.jsx("label",{children:"Tipo de disco duro"}),e.jsxs("div",{className:"d-flex flex-row",children:[e.jsxs("select",{...t("hard_type",{required:!0}),className:"form-select form-select-sm",children:[e.jsx("option",{value:"",children:"Selecciona el tipo..."}),l.id&&e.jsx("option",{value:u.hard_type,selected:!0,children:u.hard_type_name}),i.map(s=>e.jsx("option",{value:s[0],className:u.hard_type==s[0]?"d-none":"",children:s[1]},s[0]))]}),e.jsx("button",{type:"button",className:"btn btn-secondary btn-sm  addBtn px-2 ",onClick:()=>{y("Tipo de disco duro","203")},children:"+"})]}),((I=f.hard_type)==null?void 0:I.type)=="required"&&e.jsx("p",{className:"errorMsg",style:{margin:"0px"},children:"Este campo es requerido"})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{children:"Procesador"}),e.jsx("input",{type:"text",...t("proccesor"),className:"form-control form-control-sm",placeholder:"Nombre de procesador"})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{children:"Sistema operativo"}),e.jsx("input",{type:"text",...t("system"),className:"form-control form-control-sm",placeholder:"Nombre del sistema operativo"})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{htmlFor:"",children:"Estado del equipo"}),e.jsxs("select",{name:"",id:"",className:"form-select form-select-sm",...t("status"),children:[e.jsx("option",{value:"1",children:"Activo"}),e.jsx("option",{value:"2",children:"Inactivo"})]})]}),e.jsxs("div",{className:"col-md-3 my-2",children:[e.jsx("label",{htmlFor:"",children:"Antivirus"}),e.jsx("input",{type:"text",name:"antivirus",...t("antivirus"),className:"form-control form-control-sm",placeholder:"Antivirus"})]}),e.jsxs("div",{className:"col-md-3 ",children:[e.jsx("label",{htmlFor:"",children:"Fecha de compra"}),e.jsx("input",{type:"date",...t("bought_at"),className:"form-control form-control-sm"})]}),e.jsxs("div",{className:"col-md-3 ",children:[e.jsx("label",{htmlFor:"",children:"Valor inicial"}),e.jsx("input",{type:"number",placeholder:"00...",...t("init_value"),className:"form-control form-control-sm"})]}),e.jsxs("div",{className:"col-md-2 ",children:[e.jsx("label",{htmlFor:"",children:"Valor final"}),e.jsx("input",{type:"number",placeholder:"00...",...t("final_value"),className:"form-control form-control-sm"})]}),e.jsxs("div",{className:"col-md-2 ",children:[e.jsx("label",{children:"Valor subsidiado"}),e.jsx("input",{type:"text",placeholder:"0...",...t("sub_value"),className:"form-control form-control-sm"})]}),l.id?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"col-md-3  d-flex flex-row ",children:[e.jsxs("div",{children:[e.jsx("label",{children:"Agregar/descargar archivos"}),e.jsx("input",{type:"file",multiple:!0,...t("files"),className:"form-control form-control-sm"})]}),e.jsx("div",{className:"align-self-end ",children:e.jsx("button",{type:"button",className:"btn btn-dark w-100",style:{maxHeight:"31px"},onClick:()=>{document.getElementById("addModal").classList.remove("d-none")},children:e.jsx(je,{size:"1.5rem",className:"mb-5 align-self-center"})})})]})}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"col-md-3  ",children:[e.jsx("label",{children:"Agregar archivos"}),e.jsx("input",{type:"file",multiple:!0,...t("files"),className:"form-control form-control-sm"})]})}),e.jsxs("div",{className:"col-md-3 ",children:[e.jsx("label",{children:"Fecha de entrega"}),e.jsx("input",{type:"date",...t("deliver_at"),className:"form-control form-control-sm"})]}),e.jsxs("div",{className:"col-md-2 ",children:[e.jsx("label",{htmlFor:"",children:"Ubicación"}),e.jsx("input",{type:"text",placeholder:"Cali, Bogota ...",...t("location"),className:"form-control form-control-sm"})]}),S?e.jsxs("div",{className:"col-md-3 ",children:[e.jsx("label",{children:"Numero Celular"}),e.jsx("input",{type:"text",...t("phone",{required:!0}),placeholder:"3209782***",className:"form-control form-control-sm"})]}):"",e.jsxs("div",{className:S?"col-md-9":"col-md-12",children:[e.jsx("label",{children:"Comentario"}),e.jsx("textarea",{...t("description",{required:!0}),cols:"30",className:"form-control form-control-sm",style:{resize:"none"},placeholder:"Descripción..."}),((P=f.description)==null?void 0:P.type)==="required"&&e.jsx("p",{className:"errorMsg",style:{margin:"0px"},children:"Este campo es requerido"})]}),l.id?e.jsxs("div",{className:"col-md-12",children:[e.jsx("button",{className:"btn btn-success text-center my-3 btn-sm py-2",disabled:p.rol==272,children:e.jsx("span",{className:"px-1",children:"Editar"})}),e.jsx(g,{className:"btn btn-dark mx-1 py-2  btn-sm",to:`/AllEvents/${l.id}`,children:"Ver eventos de este equipo"}),p.rol==272?" ":e.jsxs(e.Fragment,{children:[e.jsx(g,{className:"btn btn-primary   py-2 btn-sm ",to:`/create_event/${l.id}`,children:e.jsx("span",{className:"px-1",children:"Añadir evento "})}),p.rol==273?"":e.jsx(g,{style:{maxHeight:"39px"},className:"btn btn-danger mx-1 btn-sm",onSubmit:s=>{s.preventDefault()},onClick:()=>{ce(l.id)},children:e.jsx(ve,{size:"1.8rem"})})]}),e.jsx(Ne,{id:l.id})]}):e.jsxs("div",{className:"col-md-12",children:[e.jsx("button",{className:" btn btn-primary text-center my-3",disabled:p.rol==272,children:"Agregar"}),e.jsx(g,{className:"btn btn-success mx-3 ",to:"/equipments",children:"Ver todo"}),e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:G,disabled:p.rol==272,children:"Carga masiva"})]})]})})})]})}export{Ae as D};
